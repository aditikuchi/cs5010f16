<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title>CS 5010: Problem Set 7</title>
<link type="text/css" rel="stylesheet" href="../css/course.css">

</head>

<body>
<h1>CS 5010: Problem Set 7</h1>

<!-- Be sure to change the problem set number both in the title and -->
<!-- the h1! -->

<p>
<strong>Out:</strong> Monday, October 24, 2016

<p><strong>Due:</strong> Monday, October 31, 2016
at 600pm local time.
</p>


<p>
The goal of this problem set is to give you practice using context
arguments and invariants.
</p>

<p>Remember that you must follow the design recipe, and write
invariants (as WHERE clauses) whenever an argument represents context
information. </p>

<p>You must use DrScheme's HtDP Intermediate Student Language with
  Lambda. Use list abstractions like filter, fold, and map whenever
  they are helpful. As before, you will be penalized for failing to
use these when they are "obviously" applicable. </p>

<p>Note: not everything on this problem set requires the use of
invariants; some may only require generalization.  Part of your task
is to figure out when you need an invariant and when you do not.
Remember, it is the purpose statement that determines whether or not
you need to state an invariant.</p>

<p>The quality of your purpose statements, invariants, and halting
measures will be an important part of the evaluation of your
submission.</p>

<p>Remember that you must follow the design recipe.  Your <a
  href="../Info/homework.html" >deliverables</a> include the data
  definitions (including interpretation and templates), contract and
  purpose header, strategies, code, and tests.  Be sure to sync your
  work and fill out a Work Session Report at the end of every work
  session.  Use the

<a href="http://goo.gl/forms/Pi631A0QoO" >[need to update] Work Session Report for
  PS07</a>.</p> 


<p>As usual, the rubric for grading is <a
href="../Info/master-rubric-public.txt" >here</a>. 
</p>


<hr>
<p/>

<ol>
  <li>You have taken a job with NextPython, Inc., the makers of
  GarterSnake.  They want to add a better user interface for their
  development environment, so they want to add a pretty-printer which
  will convert the GarterSnake syntax-tree representation, from Lesson
  7.4, into a nicely indented format.

  <p>Recall that the syntax-tree representation of GarterSnake is
  defined as follows:</p>

  <pre>
;; A Program is a ListOfDefinition.

(define-struct def (name args body))
;; A Definition is a (make-def Variable ListOfVariable Exp)
;; INTERPRETATION:
;; name is the name of the function being defined
;; args is the list of arguments of the function
;; body is the body of the function.

(define-struct varexp (name))
(define-struct appexp (fn args))

;; An Exp is one of
;; -- (make-varexp Variable)
;; -- (make-appexp Variable ListOfExp)
;; INTERPRETATION;
;; (make-varexp v)                   represents a use of the variable v
;; (make-appexp f (list e1 ... en))  represents a call to the function
;;                                   named f, with arguments e1,..,en

;; A Variable is a Symbol.
</pre>

  <p>Your task is to write</p>

  <pre>
;; program-to-strings : Program PosInt -> ListOfString
;; GIVEN: GarterSnake program and a width
;; RETURNS: a representation of the program as a sequence of lines,
;;         following the formatting rules described below.
  </pre>

  <p>The detailed formatting rules will be given below, but here's an
  example of the function:</p>

  <pre>
(define sample-program
  (list
   (make-def 'a-very-long-function-name
             (list 'x)
             (make-appexp 'f1 (list (make-varexp 'x))))
   (make-def 'f2 (list 'x 'y 'a-very-long-variable-name)
             (make-appexp 'f1 (list (make-varexp 'y))))
   (make-def 'f3 (list 'x 'z 't 'u)
             (make-appexp
              'f1
              (list (make-appexp
                     'f2 (list (make-varexp 'z)
                               (make-varexp 'y)))
                    (make-varexp 'z)
                    (make-appexp
                     'f1 (list (make-appexp
                                'f2 (list (make-varexp 'z)
                                          (make-varexp 'y)))
                               (make-varexp 'z))))))))

(program-to-strings sample-program 20)
=>
(list
 "def a-very-long-function-name (x) :"
 "    f1(x)"
 "def f2 (x,"
 "        a-very-long-variable-name,"
 "        y) :"
 "    f1(y)"
 "def f3 (x,z,t,u) :"
 "    f1(f2(z, y),"
 "       z,"
 "       f1(f2(z, y),"
 "          z))")
</pre>

<p>The formatting rules are as follows:</p>

<pre>
Layout of Programs:
Each definition should appear on one or more lines.
Lines should always be of length less than or equal to the given
width, except for a few cases listed below.
Insert a blank line between each definition.

Layout of Definitions:
Each definition should start with one line laid out as
def fnname (arg1,arg2,arg3) :
If there are 0 or 1 arguments, it should always be laid out this
way. If this doesn't fit and there are two or more arguments, it
should be laid out as 
def fnname (arg1,
            arg2,
            ..
            argn) :
If this doesn't fit, it is acceptable.
The body of the function should start on the next line, indented
by exactly 4 spaces


Layout of Expressions:
Lay out an expression horizontally if possible, e.g.
foo(e1, e2, e3)
if there are 0 arguments, it should always be laid out this
way. If this doesn't fit and there are one or more arguments, it
should be laid out as
foo(e1,
    e2,
    e3)
The first expression begins on the first line.  The closing paren is always
on the last line.  Here "e1," stands for a set of lines with a
comma at the and of the last line.

Pay attention to the spaces and the commas.  There is no space
after the colon in a definition, nor is there any space after the
right paren on the last line.

It is possible that a single variable, with the correct number of
right parentheses (and possibly a comma), does not fit on one line.
That is acceptable.

For any given program and width, these rules determine one and only
one layout.
</pre>

<p>Turn in your solution is a file named <kbd>q1.rkt</kbd>.  You also must turn
in a call graph for your solution, as in the last few problem sets.
Call this file <kbd>call-graph-1</kbd> with an appropriate suffix.  Be
sure your code includes a halting measure for every function that appears in a
cycle in your call graph.</p>

<p>This problem requires careful analysis of the context.  For example,
when your program generates the string

<pre>
 "       f1(f2(z, y),"
</pre>

what information does it need to know about the context?  If there is
more than one thing that it needs to know, you can introduce multiple
context variables to keep track of them.
</p>



<p></p>

</li>

  <li> The new model of the Pluto probe from ps02 is has just come out.
The new probe is just like the one from Problem Set 02, except for the
following:</p>

  <ol>
    <li>It is programmable.  The programming language for the robot is
    defined as follows: 

<pre>
A Program is a ListOfInstruction
Interp: A sequence of instructions, to be executed from left to
right. 

An Instruction is one of
-- (make-turn-left)            Interp: a turn-left instruction
-- (make-turn-right)           Interp: a turn-right instruction
-- (make-move-forward PosInt)  Interp: an instruction to move forward
                                       the given number of steps.
</pre>
    </li>

    <li>Alas, the new model of the Pluto probe is less reliable than
the old one.  If you send it forward by some number of steps, it may
take up to TWO steps more than you told it to, or TWO steps less than you
told it to.  As before, the probe never moves backward, nor will it ever turn
by mistake. 

<p>Thus, if the robot is facing east at x=20, then after a
<kbd>(make-move-forward 10)</kbd> instruction, it will end still facing east,
with its x-coordinate in the interval [28,32]  (that is, 30 plus or minus
    2), and  its y-coordinate unchanged.  If the instruction were
    instead <kbd>(make-move-forward 1)</kbd>, then afterwards the x coordinate
    would be in the interval [20,23] (not [19,23]).
</p>  </li> </ol>

<p>  You are to write file named <kbd>q2.rkt</kbd> that provides the following
function:
</p>

<pre>
;; probe-possible-outcome? : Int Int Program Int Int -> Bool
;; GIVEN: starting coordinates x0, y0, a robot program p, and ending
;; coordinates x1, y1.
;; RETURNS: true iff the robot, starting at (x0, y0) and facing north,
;; and executing program p according to the tolerances given above,
;; could end at (x1, y1).
;; EXAMPLES:
;; Let p1 = (list (make-turn-right)
;;                (make-move-forward 10)
;;                (make-turn-right)
;;                (make-move-forward 5))
;; then (probe-possible-outcome 20 100 p1 x1 y1) = true iff
;; x1 is in the interval [28, 32] and y1 is in the interval
;; [103,107]. 
</pre>
  
<p>For this problem, your program needs to provide acceptable
performance.  "Acceptable" means that it can provide answers for
programs of length 20 in a few seconds-- the time it takes to take a
sip of coffee.  If you are tempted to go get a fresh cup of coffee,
your program is too slow.  HINT: Small changes in your code will
probably not help.  You will need to devise a good
representation for the possible states of the robot in the middle of
the program execution.  </p>
  
</li>


</ol>


<hr>
<address></address>
<font size=-1>
<p align=right>
<!-- hhmts start -->
Last modified: Sun Oct 23 21:25:16 Eastern Daylight Time 2016 <!-- hhmts end -->
</body> </html>
